<!doctype html>
<html lang="zh-CN" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">教程：如何在本地开发和调试 Higress Pilot | Higress</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://higress.io/zh-cn/img/higress_logo_small.png"><meta data-rh="true" name="twitter:image" content="https://higress.io/zh-cn/img/higress_logo_small.png"><meta data-rh="true" property="og:url" content="https://higress.io/zh-cn/blog/pilot-debug"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="baidu-site-verification" content="codeva-T2MeTQHYnM"><meta data-rh="true" property="og:title" content="教程：如何在本地开发和调试 Higress Pilot | Higress"><meta data-rh="true" name="description" content="介绍如何在本地开发和调试 Higress 中的 Pilot 组件"><meta data-rh="true" property="og:description" content="介绍如何在本地开发和调试 Higress 中的 Pilot 组件"><meta data-rh="true" name="keywords" content="higress,pilot"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2024-03-16T00:00:00.000Z"><link data-rh="true" rel="icon" href="/zh-cn/img/higress_logo_small.png"><link data-rh="true" rel="canonical" href="https://higress.io/zh-cn/blog/pilot-debug"><link data-rh="true" rel="alternate" href="https://higress.io/en-us/blog/pilot-debug" hreflang="en-US"><link data-rh="true" rel="alternate" href="https://higress.io/zh-cn/blog/pilot-debug" hreflang="zh-CN"><link data-rh="true" rel="alternate" href="https://higress.io/blog/pilot-debug" hreflang="default"><link data-rh="true" rel="alternate" href="https://higress.io/blog/pilot-debug" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/zh-cn/blog/rss.xml" title="Higress RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-cn/blog/atom.xml" title="Higress Atom Feed">






<link rel="stylesheet" href="//g.alicdn.com/mamba/assets/0.0.19/mse-arc-ui.min.css">
<script src="//g.alicdn.com/mamba/assets/0.0.19/mse-arc-ui.min.js"></script>
<script src="https://www.googletagmanager.com/gtag/js?id=G-YHS75WKFBR" async></script><link rel="stylesheet" href="/zh-cn/assets/css/styles.69857bcd.css">
<link rel="preload" href="/zh-cn/assets/js/runtime~main.eafa2191.js" as="script">
<link rel="preload" href="/zh-cn/assets/js/main.52b6581f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-cn/"><div class="navbar__logo"><img src="//img.alicdn.com/imgextra/i1/O1CN01I7WjVs1K33EQjInid_!!6000000001107-2-tps-960-290.png" alt="Higress logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="//img.alicdn.com/imgextra/i1/O1CN01I7WjVs1K33EQjInid_!!6000000001107-2-tps-960-290.png" alt="Higress logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh-cn/">首页</a><a class="navbar__item navbar__link" href="/zh-cn/docs/overview/what-is-higress">文档</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Higress 企业版</a><ul class="dropdown__menu"><li><a href="https://www.aliyun.com/product/aliware/mse?spm=higress-website.topbar.0.0.0" target="_blank" rel="noopener noreferrer" class="dropdown__link">企业版说明</a></li><li><a href="https://free.aliyun.com/?searchKey=云原生网关&amp;spm=higress-website.topbar.0.0.0" target="_blank" rel="noopener noreferrer" class="dropdown__link">免费试用</a></li></ul></div><a href="https://survey.aliyun.com/apps/zhiliao/SmDQwdihe" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">案例征集</a><a class="navbar__item navbar__link" href="/zh-cn/docs/developers/developers_dev">开发者</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-cn/blog">博客</a><a class="navbar__item navbar__link" href="/zh-cn/community">社区</a><a href="https://github.com/alibaba/higress/releases" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">下载</a><a href="http://demo.higress.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">控制台样例</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_DSK9"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中</a><ul class="dropdown__menu"><li><a href="/en-us/blog/pilot-debug" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-US">En</a></li><li><a href="/zh-cn/blog/pilot-debug" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-CN">中</a></li></ul></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="最近博文导航"><div class="sidebarItemTitle_pO2u margin-bottom--md">所有文章</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/qwen-or-chatgpt">通义千问2.5“客串”ChatGPT4，你分的清吗</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/zh-cn/blog/pilot-debug">教程：如何在本地开发和调试 Higress Pilot</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/console-dev">教程：如何在本地开发和调试 Higress 控制台</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/admin-sdk-intro">如何使用 Higress Admin SDK 进行配置管理</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/higress-code">higress-core源码分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/e2e-debug">教程：如何在本地进行higress调试和端到端测试</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/hring">Higress 团队招募小伙伴加入～</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/release-1.3">Higress 开源一周年：新版本，新标准，新工具，新征程</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/plugin-transformer">通过 Higress Wasm 插件 3 倍性能实现 Spring-cloud-gateway 功能</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/2023-kubecon">Higress在2023 KubeCon China的分享</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/config-with-file">基于文件配置实现 Higress 极简独立部署</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/DeployOnWindows">Windows 下 Higress 部署实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/configmap">Higress 全局配置控制面原理分析</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/ai_plugin">Higress助力AI大模型企业级应用落地</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/user-mq">美洽智能客服使用 Higress 统一网关落地实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/skywalking">Higress 集成 Skywalking 可观测性探索</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/ospp-2023">Higress 开源之夏项目报名</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/release-100">上线控制台，降低使用门槛 ｜ Higress 1.0.0 RC 版本发布</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/user-uu">UU跑腿基于Higress的云原生网关实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/release-070">Higress 0.7.0 版本发布：GA 进入倒计时</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/nacos">Higress + Nacos 微服务网关最佳实践</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/30-line-wasm">30行代码写一个Wasm Go插件</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/first-meetup">欢迎报名Higress首次线下Meetup</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/zh-cn/blog/higress">阿里巴巴重磅开源云原生网关</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><meta itemprop="description" content="介绍如何在本地开发和调试 Higress 中的 Pilot 组件"><meta itemprop="keywords" content="higress,pilot"><header><h1 class="title_f1Hy" itemprop="headline">教程：如何在本地开发和调试 Higress Pilot</h1><div class="container_mt6G margin-vert--md"><time datetime="2024-03-16T00:00:00.000Z" itemprop="datePublished">2024年3月16日</time> · <!-- -->阅读需 6 分钟</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><span itemprop="name">CH3CHO</span></div></div></div></div></div></header><div id="__blog-post-container" class="markdown" itemprop="articleBody"><h2 class="anchor anchorWithStickyNavbar_LWe7" id="背景说明">背景说明<a href="#背景说明" class="hash-link" aria-label="背景说明的直接链接" title="背景说明的直接链接">​</a></h2><p>前面 SJC 在<a href="/zh-cn/blog/e2e-debug">这篇博客</a>中介绍了如何在本地开发和调试 Higress Controller。而 Higress 控制面除了 Controller 之外还有一个组件，那就是 Pilot。本文就将介绍如何在本地开发和调试 Higress Pilot。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="环境准备">环境准备<a href="#环境准备" class="hash-link" aria-label="环境准备的直接链接" title="环境准备的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="步骤一克隆代码仓库">步骤一：克隆代码仓库<a href="#步骤一克隆代码仓库" class="hash-link" aria-label="步骤一：克隆代码仓库的直接链接" title="步骤一：克隆代码仓库的直接链接">​</a></h3><p>Pilot 的代码目前是以 Istio 上游仓库 submodule 加补丁文件的形式存在于 Higress 的主仓库中的，所以直接克隆 Higress 的代码主仓库 <a href="https://github.com/alibaba/higress" target="_blank" rel="noopener noreferrer">https://github.com/alibaba/higress</a> 即可。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="步骤二准备项目代码">步骤二：准备项目代码<a href="#步骤二准备项目代码" class="hash-link" aria-label="步骤二：准备项目代码的直接链接" title="步骤二：准备项目代码的直接链接">​</a></h3><p>Higress Pilot 是在 Istio Pilot 的基础上，基于 Higress 自身的功能需求进行了二次开发而构建而成的，所以我们这里需要下载上游代码仓库并应用现有的补丁。我们只需要执行下面这条命令：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">make</span><span class="token plain"> prebuild</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Windows 用户注意了！</strong></p><p>如果你是在 Windows 上进行开发，并且执行 <code>make</code> 命令有困难的话，不要怕，我们也有办法。因为整个 prebuild 其实也只做了两件事情。</p><p>第一件事情是初始化所有的上游子模块，只需要执行这样一条命令：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">git</span><span class="token plain"> submodule update --init</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>第二件事情是初始化开发目录。这一步骤执行的就是 <code>tools/hack/prebuild.sh</code>。大家可以直接在 Cygwin 或者 Git Bash 等类 Linux 终端下执行这个脚本文件。</p><p>如果在应用补丁的时候出现了和换行符有关的报错，那么可以编辑 <code>prebuild.sh</code>，给两处 <code>patch</code> 命令增加 <code>--binary</code> 参数即可。</p><p><img loading="lazy" alt="img.png" src="/zh-cn/assets/images/patch-binary-0a2e0fe071efb18bdf0d5d7aecb07e6b.png" width="862" height="651" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="步骤三安装-higress">步骤三：安装 Higress<a href="#步骤三安装-higress" class="hash-link" aria-label="步骤三：安装 Higress的直接链接" title="步骤三：安装 Higress的直接链接">​</a></h3><p>既然只是调试 pilot，那么其他组件还是要复用现有 Higress 集群里的。所以我们需要在本地配置一个 Higress 集群。大家可以参考这篇文档：<a href="/zh-cn/docs/user/quickstart">链接</a>。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="开发与调试">开发与调试<a href="#开发与调试" class="hash-link" aria-label="开发与调试的直接链接" title="开发与调试的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="本地开发">本地开发<a href="#本地开发" class="hash-link" aria-label="本地开发的直接链接" title="本地开发的直接链接">​</a></h3><p>本地开发推荐使用 IDE JetBrains GoLand。我们直接在 GoLand 中打开 <code>external/istio</code> 目录，正常进行开发即可。</p><p><img loading="lazy" alt="img.png" src="/zh-cn/assets/images/goland-project-9e47f05886a80bb1ac0a6113d4f4966f.png" width="1419" height="722" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="调试运行">调试运行<a href="#调试运行" class="hash-link" aria-label="调试运行的直接链接" title="调试运行的直接链接">​</a></h3><p><strong>环境准备</strong></p><p>第一步：提取配置文件</p><p>在本地任意一个位置创建一个目录，然后在该目录下执行以下命令，生成配置文件：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get configmap higress-config -n higress-system -o</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">jsonpath</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;{.data.mesh}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./mesh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get configmap higress-config -n higress-system -o</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">jsonpath</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;{.data.meshNetworks}&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ./meshNetworks</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>第二步：转发 controller 端口</p><p>执行以下命令，将 controller 的 xDS 服务端口转发至本地：</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl port-forward deployment/higress-controller -n higress-system </span><span class="token number" style="color:#36acaa">15051</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>代码调整</strong></p><p>如果要调试与 TLS 证书下发的相关功能，则需要在 <code>pilot/pkg/xds/ads.go</code> 的 <code>initConnection</code> 函数中添加代码，绕过证书下发过程的认证要求。代码修改方法请参考下方示例。</p><div class="language-go codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-go codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> features</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">EnableXDSIdentityCheck </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> con</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Identities </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic">// TODO: allow locking down, rejecting unauthenticated requests.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">:=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">checkConnectionIdentity</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">con</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> err </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">nil</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            log</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Warnf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Unauthorized XDS: %v with identity %v: %v&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> con</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PeerAddr</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> con</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Identities</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> status</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Newf</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">codes</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">PermissionDenied</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;authorization failed: %v&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">Err</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        con</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">proxy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VerifiedIdentity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Start - Auth bypassing for local debug</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    con</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">proxy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">VerifiedIdentity </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain">spiffe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Identity</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        TrustDomain</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;cluster.local&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Namespace</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">      </span><span class="token string" style="color:#e3116c">&quot;higress-system&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ServiceAccount</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;higress-gateway&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// End - Auth bypassing for local debug</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>运行配置</strong></p><p>配置一：环境变量</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token assign-left variable" style="color:#36acaa">CUSTOM_CA_CERT_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">higress-ca-root-cert</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">JWT_POLICY</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">none</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PILOT_ENABLE_CROSS_CLUSTER_WORKLOAD_ENTRY</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PILOT_ENABLE_GATEWAY_API</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PILOT_ENABLE_GATEWAY_API_DEPLOYMENT_CONTROLLER</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PILOT_ENABLE_GATEWAY_API_STATUS</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PILOT_ENABLE_METADATA_EXCHANGE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">PILOT_SCOPE_GATEWAY_TO_NAMESPACE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">POD_NAME</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">higress-controller</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">POD_NAMESPACE</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">higress-system</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">REVISION</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">default</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token assign-left variable" style="color:#36acaa">VALIDATION_ENABLED</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">false</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>配置二：命令行参数</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">discovery --monitoringAddr</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">:15014 --log_output_level</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">default:info --domain cluster.local --keepaliveMaxServerConnectionAge 30m --meshConfig </span><span class="token variable" style="color:#36acaa">${configDir}</span><span class="token plain">/mesh --networksConfig </span><span class="token variable" style="color:#36acaa">${configDir}</span><span class="token plain">/meshNetworks</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>注意：其中的 <code>${configDir}</code> 为在<strong>环境准备</strong>一步创建的配置目录。</p><p><strong>启动调试</strong></p><p>在完成以上工作之后，我们就可以启动 Pilot 了。它的 main 函数定义在 <code>pilot/cmd/pilot-discovery/main.go</code> 文件中。</p><p><img loading="lazy" alt="img.png" src="/zh-cn/assets/images/debug-run-b2c3f7a50afb761c6fb1e0182a190044.png" width="1501" height="435" class="img_ev3q"></p><p><strong>网关对接</strong></p><p>如果想要验证 pilot 下发配置到 gateway 的功能，我们需要修改 gateway 的配置，使之连接到处于开发状态的 pilot 实例。</p><p>第一步：修改 <code>higress-config</code> ConfigMap</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl edit configmap higress-config -n higress-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>修改两个地方：</p><ol><li>将 <code>discoveryAddress</code> 修改为<code>本机IP:15010</code>；<br>注意：此处的本机 IP 不可以使用 127.0.0.1 等 loopback IP。需要使用本机有线或无线网卡的 IP。</li><li>在 <code>discoveryAddress</code> 下面添加一个新属性：<code>controlPlaneAuthPolicy: NONE</code>。</li></ol><p>修改后配置示例：</p><p><img loading="lazy" alt="img.png" src="data:image/png;base64,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" width="549" height="250" class="img_ev3q"></p><p>第二步：重启 Higress Gateway</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl rollout restart deployment higress-gateway -n higress-system</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>重启后我们可以在 pilot 的控制台输出中看到 gateway 连接上来的并获取配置的日志。</p><p><img loading="lazy" alt="img.png" src="/zh-cn/assets/images/gateway-connected-7884dc4a25d714a194c1605ba474d1a8.png" width="1494" height="462" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="总结">总结<a href="#总结" class="hash-link" aria-label="总结的直接链接" title="总结的直接链接">​</a></h2><p>本地调试和测试是开发过程中必不可少的环节。通过本文的介绍，希望大家可以更加方便的对 pilot 进行本地调试和e2e测试，提高开发效率。同时也希望能够有越来越多的开发者加入到 Higress 研发队伍中，为产品的升级迭代贡献一份力量。</p><p><a href="https://github.com/alibaba/higress/issues/480" target="_blank" rel="noopener noreferrer">欢迎参与阿里开源贡献👏</a></p></div><footer class="row docusaurus-mt-lg blogPostFooterDetailsFull_mRVl"><div class="col margin-top--sm"><a href="https://github.com/higress-group/higress-group.github.io/blob/main/i18n/zh-cn/docusaurus-plugin-content-blog/pilot-debug.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="博文分页导航"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-cn/blog/qwen-or-chatgpt"><div class="pagination-nav__sublabel">较新一篇</div><div class="pagination-nav__label">通义千问2.5“客串”ChatGPT4，你分的清吗</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-cn/blog/console-dev"><div class="pagination-nav__sublabel">较旧一篇</div><div class="pagination-nav__label">教程：如何在本地开发和调试 Higress 控制台</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#背景说明" class="table-of-contents__link toc-highlight">背景说明</a></li><li><a href="#环境准备" class="table-of-contents__link toc-highlight">环境准备</a><ul><li><a href="#步骤一克隆代码仓库" class="table-of-contents__link toc-highlight">步骤一：克隆代码仓库</a></li><li><a href="#步骤二准备项目代码" class="table-of-contents__link toc-highlight">步骤二：准备项目代码</a></li><li><a href="#步骤三安装-higress" class="table-of-contents__link toc-highlight">步骤三：安装 Higress</a></li></ul></li><li><a href="#开发与调试" class="table-of-contents__link toc-highlight">开发与调试</a><ul><li><a href="#本地开发" class="table-of-contents__link toc-highlight">本地开发</a></li><li><a href="#调试运行" class="table-of-contents__link toc-highlight">调试运行</a></li></ul></li><li><a href="#总结" class="table-of-contents__link toc-highlight">总结</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">愿景</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/">为用户提供一站式云原生网关解决方案.</a></li></ul></div><div class="col footer__col"><div class="footer__title">文档</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/docs/overview/what-is-higress">Higress是什么?</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-cn/docs/user/quickstart">快速开始</a></li><li class="footer__item"><a href="https://github.com/higress-group/higress-group.github.io/issues/new" target="_blank" rel="noopener noreferrer" class="footer__link-item">报告文档问题<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/higress-group/higress-group.github.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">在GitHub上编辑此文档<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">资源</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/zh-cn/blog">博客</a></li><li class="footer__item"><a class="footer__link-item" href="/zh-cn/community">社区</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="//img.alicdn.com/imgextra/i2/O1CN01oNTGgE1lfW7oEPIzP_!!6000000004846-2-tps-960-290.png" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="120" height="36"><img src="//img.alicdn.com/imgextra/i2/O1CN01oNTGgE1lfW7oEPIzP_!!6000000004846-2-tps-960-290.png" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="120" height="36"></div><div class="footer__copyright">Copyright © 2023 Higress<br>浙公网安备 33011002016922号 浙ICP备12022327号-1119</div></div></div></footer></div>
<script src="/zh-cn/assets/js/runtime~main.eafa2191.js"></script>
<script src="/zh-cn/assets/js/main.52b6581f.js"></script>
</body>
</html>