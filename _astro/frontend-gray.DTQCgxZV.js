const n="latest/zh-cn/plugins/transformation/frontend-gray.md",e="docs",a="latest/zh-cn/plugins/transformation/frontend-gray",r="\n## \u529F\u80FD\u8BF4\u660E\n`frontend-gray`\u63D2\u4EF6\u5B9E\u73B0\u4E86\u524D\u7AEF\u7528\u6237\u7070\u5EA6\u7684\u7684\u529F\u80FD\uFF0C\u901A\u8FC7\u6B64\u63D2\u4EF6\uFF0C\u4E0D\u4F46\u53EF\u4EE5\u7528\u4E8E\u4E1A\u52A1`A/B\u5B9E\u9A8C`\uFF0C\u540C\u65F6\u901A\u8FC7`\u53EF\u7070\u5EA6`\u914D\u5408`\u53EF\u76D1\u63A7`,`\u53EF\u56DE\u6EDA`\u7B56\u7565\u4FDD\u8BC1\u7CFB\u7EDF\u53D1\u5E03\u8FD0\u7EF4\u7684\u7A33\u5B9A\u6027\u3002\n\n## \u8FD0\u884C\u5C5E\u6027\n\n\u63D2\u4EF6\u6267\u884C\u9636\u6BB5\uFF1A`\u8BA4\u8BC1\u9636\u6BB5`\n\u63D2\u4EF6\u6267\u884C\u4F18\u5148\u7EA7\uFF1A`450`\n\n\n## \u914D\u7F6E\u5B57\u6BB5\n| \u540D\u79F0             | \u6570\u636E\u7C7B\u578B         | \u586B\u5199\u8981\u6C42 | \u9ED8\u8BA4\u503C | \u63CF\u8FF0                                                                                                 |\n|----------------|--------------|----|-----|----------------------------------------------------------------------------------------------------|\n| `grayKey`         | string       | \u975E\u5FC5\u586B | -   | \u7528\u6237ID\u7684\u552F\u4E00\u6807\u8BC6\uFF0C\u53EF\u4EE5\u6765\u81EACookie\u6216\u8005Header\u4E2D\uFF0C\u6BD4\u5982 userid\uFF0C\u5982\u679C\u6CA1\u6709\u586B\u5199\u5219\u4F7F\u7528`rules[].grayTagKey`\u548C`rules[].grayTagValue`\u8FC7\u6EE4\u7070\u5EA6\u89C4\u5219 |\n| `graySubKey`    | string       | \u975E\u5FC5\u586B | -   | \u7528\u6237\u8EAB\u4EFD\u4FE1\u606F\u53EF\u80FD\u4EE5JSON\u5F62\u5F0F\u900F\u51FA\uFF0C\u6BD4\u5982\uFF1A`userInfo:{ userCode:\"001\" }`,\u5F53\u524D\u4F8B\u5B50`graySubKey`\u53D6\u503C\u4E3A`userCode`                   |\n| `rules`      | array of object | \u5FC5\u586B | -   | \u7528\u6237\u5B9A\u4E49\u4E0D\u540C\u7684\u7070\u5EA6\u89C4\u5219\uFF0C\u9002\u914D\u4E0D\u540C\u7684\u7070\u5EA6\u573A\u666F                                                                              |\n| `rewrite`      | object | \u5FC5\u586B | -   | \u91CD\u5199\u914D\u7F6E\uFF0C\u4E00\u822C\u7528\u4E8EOSS/CDN\u524D\u7AEF\u90E8\u7F72\u7684\u91CD\u5199\u914D\u7F6E                                                                           |\n| `baseDeployment` | object   | \u975E\u5FC5\u586B | -   | \u914D\u7F6EBase\u57FA\u7EBF\u89C4\u5219\u7684\u914D\u7F6E                                                                                      |\n| `grayDeployments` |  array of object   | \u975E\u5FC5\u586B | -   | \u914D\u7F6EGray\u7070\u5EA6\u7684\u751F\u6548\u89C4\u5219\uFF0C\u4EE5\u53CA\u751F\u6548\u7248\u672C                                                                               |\n\n`rules`\u5B57\u6BB5\u914D\u7F6E\u8BF4\u660E\uFF1A\n\n| \u540D\u79F0             | \u6570\u636E\u7C7B\u578B         | \u586B\u5199\u8981\u6C42 | \u9ED8\u8BA4\u503C | \u63CF\u8FF0                                                                                |\n|----------------|--------------|------|-----|-----------------------------------------------------------------------------------|\n| `name`         | string       | \u5FC5\u586B   | -   | \u89C4\u5219\u540D\u79F0\u552F\u4E00\u6807\u8BC6\uFF0C\u548C`deploy.gray[].name`\u8FDB\u884C\u5173\u8054\u751F\u6548                                          |\n| `grayKeyValue`    | array of string       | \u975E\u5FC5\u586B   | -   | \u7528\u6237ID \u767D\u540D\u5355\u5217\u8868 |\n| `grayTagKey`      | string | \u975E\u5FC5\u586B  | -   | \u7528\u6237\u5206\u7C7B\u6253\u6807\u7684\u6807\u7B7Ekey\u503C\uFF0C\u6765\u81EACookie                                                             |\n| `grayTagValue` | array of string   | \u975E\u5FC5\u586B  | -   | \u7528\u6237\u5206\u7C7B\u6253\u6807\u7684\u6807\u7B7Evalue\u503C\uFF0C\u6765\u81EACookie                                                         |\n\n`rewrite`\u5B57\u6BB5\u914D\u7F6E\u8BF4\u660E\uFF1A\n> `indexRouting`\u9996\u9875\u91CD\u5199\u548C`fileRouting`\u6587\u4EF6\u91CD\u5199\uFF0C\u672C\u8D28\u90FD\u662F\u524D\u7F00\u5339\u914D\uFF0C\u6BD4\u5982`/app1`: `/mfe/app1/{version}/index.html`\u4EE3\u8868/app1\u4E3A\u524D\u7F00\u7684\u8BF7\u6C42\uFF0C\u8DEF\u7531\u5230`/mfe/app1/{version}/index.html`\u9875\u9762\u4E0A\uFF0C\u5176\u4E2D`{version}`\u4EE3\u8868\u7248\u672C\u53F7\uFF0C\u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u4F1A\u88AB`baseDeployment.version`\u6216\u8005`grayDeployments[].version`\u52A8\u6001\u66FF\u6362\u3002\n\n> `{version}` \u4F5C\u4E3A\u4FDD\u7559\u5B57\u6BB5\uFF0C\u5728\u6267\u884C\u8FC7\u7A0B\u4E2D\u4F1A\u88AB`baseDeployment.version`\u6216\u8005`grayDeployments[].version`\u52A8\u6001\u66FF\u6362\u524D\u7AEF\u7248\u672C\u3002\n\n\n| \u540D\u79F0         | \u6570\u636E\u7C7B\u578B         | \u586B\u5199\u8981\u6C42 | \u9ED8\u8BA4\u503C | \u63CF\u8FF0                           |\n|------------|--------------|------|-----|------------------------------|\n| `host`     | string       | \u975E\u5FC5\u586B  | -   | host\u5730\u5740\uFF0C\u5982\u679C\u662FOSS\u5219\u8BBE\u7F6E\u4E3A VPC \u5185\u7F51\u8BBF\u95EE\u5730\u5740 |\n| `notFoundUri` | string       | \u975E\u5FC5\u586B  | -   | 404 \u9875\u9762\u914D\u7F6E                     |\n| `indexRouting`    | map of string to string       | \u975E\u5FC5\u586B  | -   | \u7528\u4E8E\u5B9A\u4E49\u9996\u9875\u91CD\u5199\u8DEF\u7531\u89C4\u5219\u3002\u6BCF\u4E2A\u952E (Key) \u8868\u793A\u9996\u9875\u7684\u8DEF\u7531\u8DEF\u5F84\uFF0C\u503C (Value) \u5219\u6307\u5411\u91CD\u5B9A\u5411\u7684\u76EE\u6807\u6587\u4EF6\u3002\u4F8B\u5982\uFF0C\u952E\u4E3A `/app1` \u5BF9\u5E94\u7684\u503C\u4E3A `/mfe/app1/{version}/index.html`\u3002\u751F\u6548version\u4E3A`0.0.1`\uFF0C \u8BBF\u95EE\u8DEF\u5F84\u4E3A `/app1`\uFF0C\u5219\u91CD\u5B9A\u5411\u5230 `/mfe/app1/0.0.1/index.html`\u3002                     |\n| `fileRouting`     | map of string to string       | \u975E\u5FC5\u586B  | -   | \u7528\u4E8E\u5B9A\u4E49\u8D44\u6E90\u6587\u4EF6\u91CD\u5199\u8DEF\u7531\u89C4\u5219\u3002\u6BCF\u4E2A\u952E (Key) \u8868\u793A\u8D44\u6E90\u8BBF\u95EE\u8DEF\u5F84\uFF0C\u503C (Value) \u5219\u6307\u5411\u91CD\u5B9A\u5411\u7684\u76EE\u6807\u6587\u4EF6\u3002\u4F8B\u5982\uFF0C\u952E\u4E3A `/app1/` \u5BF9\u5E94\u7684\u503C\u4E3A `/mfe/app1/{version}`\u3002\u751F\u6548version\u4E3A`0.0.1`\uFF0C\u8BBF\u95EE\u8DEF\u5F84\u4E3A `/app1/js/a.js`\uFF0C\u5219\u91CD\u5B9A\u5411\u5230 `/mfe/app1/0.0.1/js/a.js`\u3002                     |\n\n`baseDeployment`\u5B57\u6BB5\u914D\u7F6E\u8BF4\u660E\uFF1A\n\n| \u540D\u79F0             | \u6570\u636E\u7C7B\u578B         | \u586B\u5199\u8981\u6C42 | \u9ED8\u8BA4\u503C | \u63CF\u8FF0                                                                                |\n|----------------|--------------|------|-----|-----------------------------------------------------------------------------------|\n| `version`         | string       | \u5FC5\u586B   | -   | Base\u7248\u672C\u7684\u7248\u672C\u53F7\uFF0C\u4F5C\u4E3A\u515C\u5E95\u7684\u7248\u672C                                         |\n\n`grayDeployments`\u5B57\u6BB5\u914D\u7F6E\u8BF4\u660E\uFF1A\n\n| \u540D\u79F0     | \u6570\u636E\u7C7B\u578B   | \u586B\u5199\u8981\u6C42 | \u9ED8\u8BA4\u503C | \u63CF\u8FF0                                              |\n|--------|--------|------|-----|-------------------------------------------------|\n| `version`  | string | \u5FC5\u586B   | -   | Gray\u7248\u672C\u7684\u7248\u672C\u53F7\uFF0C\u5982\u679C\u547D\u4E2D\u7070\u5EA6\u89C4\u5219\uFF0C\u5219\u4F7F\u7528\u6B64\u7248\u672C\u3002\u5982\u679C\u662F\u975ECDN\u90E8\u7F72\uFF0C\u5728header\u6DFB\u52A0`x-higress-tag`                     |\n| `backendVersion`  | string | \u5FC5\u586B   | -   | \u540E\u7AEF\u7070\u5EA6\u7248\u672C\uFF0C\u4F1A\u5728`XHR/Fetch`\u8BF7\u6C42\u7684header\u5934\u6DFB\u52A0 `x-mse-tag`\u5230\u540E\u7AEF |\n| `name` | string | \u5FC5\u586B   | -   | \u89C4\u5219\u540D\u79F0\u548C`rules[].name`\u5173\u8054\uFF0C                          |\n| `enabled`  | boolean   | \u5FC5\u586B   | -   | \u662F\u5426\u542F\u52A8\u5F53\u524D\u7070\u5EA6\u89C4\u5219                                      |\n\n## \u914D\u7F6E\u793A\u4F8B\n### \u57FA\u7840\u914D\u7F6E\n```yml\ngrayKey: userid\nrules:\n- name: inner-user\n  grayKeyValue:\n  - '00000001'\n  - '00000005'\n- name: beta-user\n  grayKeyValue:\n  - '00000002'\n  - '00000003'\n  grayTagKey: level\n  grayTagValue:\n  - level3\n  - level5\nbaseDeployment:\n  version: base\ngrayDeployments:\n  - name: beta-user\n    version: gray\n    enabled: true\n```\n\n\ncookie\u4E2D\u7684\u7528\u6237\u552F\u4E00\u6807\u8BC6\u4E3A `userid`\uFF0C\u5F53\u524D\u7070\u5EA6\u89C4\u5219\u914D\u7F6E\u4E86`beta-user`\u7684\u89C4\u5219\u3002\n\n\u5F53\u6EE1\u8DB3\u4E0B\u9762\u8C03\u8BD5\u7684\u65F6\u5019\uFF0C\u4F1A\u4F7F\u7528`version: gray`\u7248\u672C\n- cookie\u4E2D`userid`\u7B49\u4E8E`00000002`\u6216\u8005`00000003`\n- cookie\u4E2D`level`\u7B49\u4E8E`level3`\u6216\u8005`level5`\u7684\u7528\u6237\n\n\u5426\u5219\u4F7F\u7528`version: base`\u7248\u672C\n\n### \u7528\u6237\u4FE1\u606F\u5B58\u5728JSON\u4E2D\n\n```yml\ngrayKey: appInfo\ngraySubKey: userId\nrules:\n- name: inner-user\n  grayKeyValue:\n  - '00000001'\n  - '00000005'\n- name: beta-user\n  grayKeyValue:\n  - '00000002'\n  - '00000003'\n  grayTagKey: level\n  grayTagValue:\n  - level3\n  - level5\nbaseDeployment:\n  version: base\ngrayDeployments:\n  - name: beta-user\n    version: gray\n    enabled: true\n```\n\ncookie\u5B58\u5728`appInfo`\u7684JSON\u6570\u636E\uFF0C\u5176\u4E2D\u5305\u542B`userId`\u5B57\u6BB5\u4E3A\u5F53\u524D\u7684\u552F\u4E00\u6807\u8BC6\n\u5F53\u524D\u7070\u5EA6\u89C4\u5219\u914D\u7F6E\u4E86`beta-user`\u7684\u89C4\u5219\u3002\n\u5F53\u6EE1\u8DB3\u4E0B\u9762\u8C03\u8BD5\u7684\u65F6\u5019\uFF0C\u4F1A\u4F7F\u7528`version: gray`\u7248\u672C\n- cookie\u4E2D`userid`\u7B49\u4E8E`00000002`\u6216\u8005`00000003`\n- cookie\u4E2D`level`\u7B49\u4E8E`level3`\u6216\u8005`level5`\u7684\u7528\u6237\n\n\u5426\u5219\u4F7F\u7528`version: base`\u7248\u672C\n\n### rewrite\u91CD\u5199\u914D\u7F6E\n> \u4E00\u822C\u7528\u4E8ECDN\u90E8\u7F72\u573A\u666F\n```yml\ngrayKey: userid\nrules:\n- name: inner-user\n  grayKeyValue:\n  - '00000001'\n  - '00000005'\n- name: beta-user\n  grayKeyValue:\n  - '00000002'\n  - '00000003'\n  grayTagKey: level\n  grayTagValue:\n  - level3\n  - level5\nrewrite:\n  host: frontend-gray.oss-cn-shanghai-internal.aliyuncs.com\n  notFoundUri: /mfe/app1/dev/404.html\n  indexRouting:\n    /app1: '/mfe/app1/{version}/index.html'\n    /: '/mfe/app1/{version}/index.html',\n  fileRouting:\n    /: '/mfe/app1/{version}'\n    /app1/: '/mfe/app1/{version}'\nbaseDeployment:\n  version: base\ngrayDeployments:\n  - name: beta-user\n    version: gray\n    enabled: true\n```\n\n`{version}`\u4F1A\u5728\u8FD0\u884C\u8FC7\u7A0B\u4E2D\u52A8\u6001\u66FF\u6362\u4E3A\u771F\u6B63\u7684\u7248\u672C\n\n#### indexRouting\uFF1A\u9996\u9875\u8DEF\u7531\u914D\u7F6E\n\u8BBF\u95EE `/app1`, `/app123`,`/app1/index.html`, `/app1/xxx`, `/xxxx` \u90FD\u4F1A\u8DEF\u7531\u5230'/mfe/app1/{version}/index.html'\n\n#### fileRouting\uFF1A\u6587\u4EF6\u8DEF\u7531\u914D\u7F6E\n\u4E0B\u9762\u6587\u4EF6\u6620\u5C04\u5747\u751F\u6548\n- `/js/a.js` => `/mfe/app1/v1.0.0/js/a.js`\n- `/js/template/a.js` => `/mfe/app1/v1.0.0/js/template/a.js`\n- `/app1/js/a.js` => `/mfe/app1/v1.0.0/js/a.js`\n- `/app1/js/template/a.js` => `/mfe/app1/v1.0.0/js/template/a.js`\n\n",s={title:"\u524D\u7AEF\u7070\u5EA6",description:"\u524D\u7AEF\u7070\u5EA6\u63D2\u4EF6\u914D\u7F6E\u53C2\u8003",editUrl:!0,head:[],template:"doc",sidebar:{hidden:!1,attrs:{}},pagefind:!0,keywords:["higress","frontend gray"]},o={type:"content",filePath:"/home/runner/work/higress-group.github.io/higress-group.github.io/src/content/docs/latest/zh-cn/plugins/transformation/frontend-gray.md",rawData:void 0};export{o as _internal,r as body,e as collection,s as data,n as id,a as slug};
